<%- include('partials/navbarMain.ejs') %>

<div class="page-wrapper">
  <div class='card'>
    <div class="alert-box full-width">
        <%- include ("flashMessages") %>
    </div>

    <div class='workflow-order-header'>
      
      <div class='header-description'>
        <h1 class='text-blue'>Order Workflow</h1>
        <p>All jobs tickets can be found in the departments below.</p>

      </div>
      <div class='worlkflow-navigation'>
        <ul class='navigation-list full-width'>
          <li data-department="ORDER-PREP">Order Prep</li>
          <li data-department="ART-PREP">Art Prep</li>
          <li data-department="PRE-PRESS">Pre-Press</li>
          <li data-department="PRINTING">Printing</li>
          <li data-department="CUTTING">Cutting</li>
          <li data-department="WINDING">Winding</li>
          <li data-department="SHIPPING">Shipping</li>
          <li data-department="BILLING">Billing</li>
        </ul>

      </div>
      <div class='workflow-filter flex-center-left-row'>

        <button class='create bg-blue text-white border-blue btn-create'>Create <i class="fa-regular fa-plus"></i></button>

        <div class='search-wrapper flex-center-left-row'>
          <i class="fa-regular fa-magnifying-glass flex-center-center-row"></i><input placeholder='Search' value='' class='search-input'>
        </div>

        <div class='person-filter-wrapper tooltip'>
          <button class='filter btn-person-filter'>
            <span class="tooltiptext">Filter by person</span>
            <i class='fa-regular fa-circle-user'></i> Person
          </button>
          <div class='person-filter-dropdown dropdown'>
            <h5><b>Quick person filter</b></h5>
            <p>Filter items and subitems by person.</p>
          </div>
        </div>

        <div class='split-btn-frame btn-filter flex-center-center-row tooltip'>
          <span class="tooltiptext">Filter by anything</span>
          <div class='filter-btn-wrapper flex-center-center-row'>
            <button class='btn-split quick-filter flex-center-center-row'>
              <i class="fa-light fa-filter"></i>Filter
            </button>
            <button class='btn-split-arrow-dropdown btn-advanced-filter'><i class="fa-regular fa-chevron-down"></i></button>
          </div>

          <div class='quick-filter-dropdown dropdown'>
            <h5><b>Quick Filter</b></h5>
            <p>Testing how big the dropdown box can be</p>
          </div>

          <div class='advanced-filter-dropdown dropdown'>
            <h5><b>Advanced Filter</b></h5>
            <p>Testing how big the dropdown box can be</p>
          </div>
        </div>

        <div class='sort-wrapper tooltip'>
          <span class="tooltiptext">Sort by any column</span>
          <button class='sort btn-sort'><i class="fa-regular fa-arrow-down-arrow-up"></i> Sort</button>
          <div class='sort-dropdown dropdown'>
            <h5><b>Sort by</b></h5>
            <p>Testing how big the dropdown box can be</p>
          </div>
        </div>

        <div class='all-wrapper tooltip'>
          <a href="/tickets">
            <span class="tooltiptext">See All</span>
            <button class='sort btn-sort' href="/tickets"><i class="fa-solid fa-layer-group"></i> See All</button>
          </a>
        </div>

      </div>

    </div>

    <br>
    <br>
    <br>

    <% const orderPrepTicketsGroupedBySubDepartment = ticketsGroupedByDestination['ORDER-PREP'] %>
    <% const artPrepTicketsGroupedBySubDepartment = ticketsGroupedByDestination['ART-PREP'] %>
    <% const prePressTicketsGroupedBySubDepartment = ticketsGroupedByDestination['PRE-PRESS'] %>
    <% const printingTicketsGroupedBySubDepartment = ticketsGroupedByDestination['PRINTING'] %>
    <% const cuttingTicketsGroupedBySubDepartment = ticketsGroupedByDestination['CUTTING'] %>
    <% const windingTicketsGroupedBySubDepartment = ticketsGroupedByDestination['WINDING'] %>
    <% const shippingTicketsGroupedBySubDepartment = ticketsGroupedByDestination['SHIPPING'] %>
    <% const billingTicketsGroupedBySubDepartment = ticketsGroupedByDestination['BILLING'] %>

    <% const orderPrepNeedsAttentionTickets = orderPrepTicketsGroupedBySubDepartment['NEEDS ATTENTION'] %>
    <% const orderPrepSendToCustomerTickets = orderPrepTicketsGroupedBySubDepartment['SEND TO CUSTOMER'] %>
    <% const orderPrepWaitingOnApprovalTickets = orderPrepTicketsGroupedBySubDepartment['WAITING ON APPROVAL'] %>
    <% const orderPrepWaitingOnCustomerTickets = orderPrepTicketsGroupedBySubDepartment['WAITING ON CUSTOMER'] %>
    <% const orderPrepReadyToOrderTickets = orderPrepTicketsGroupedBySubDepartment['READY TO ORDER PLATE OR DIE'] %>
    <% const orderPrepInProgressTickets = orderPrepTicketsGroupedBySubDepartment['IN PROGRESS'] %> <!-- TODO: This table is missing and therefore this variable is unused right now, ask storm about it -->

    <% const artPrepNeedsAttentionTickets = artPrepTicketsGroupedBySubDepartment['NEEDS ATTENTION'] %>
    <% const artPrepInProgressTickets = artPrepTicketsGroupedBySubDepartment['IN PROGRESS'] %>
    <% const artPrepNeedsProofTickets = artPrepTicketsGroupedBySubDepartment['NEEDS PROOF'] %>
    <% const artPrepNeedsDieLineTickets = artPrepTicketsGroupedBySubDepartment['NEEDS DIE LINE'] %>
    <% const artPrepNeedsPlateTickets = artPrepTicketsGroupedBySubDepartment['NEEDS PLATE'] %>

    <% const prePressNeedsAttentionTickets = prePressTicketsGroupedBySubDepartment['NEEDS ATTENTION'] %>
    <% const prePressInProgressTickets = prePressTicketsGroupedBySubDepartment['IN PROGRESS'] %>
    <% const prePressSendToPressTickets = prePressTicketsGroupedBySubDepartment['SEND TO PRESS'] %>

    <% const printingInProgressTickets = printingTicketsGroupedBySubDepartment['IN PROGRESS'] %>
    <% const printingReadyForSchedulingTickets = printingTicketsGroupedBySubDepartment['READY FOR SCHEDULING'] %>
    <% const printingSchedulePressOneTickets = printingTicketsGroupedBySubDepartment['SCHEDULE PRESS ONE'] %>
    <% const printingSchedulePressTwoTickets = printingTicketsGroupedBySubDepartment['SCHEDULE PRESS TWO'] %>
    <% const printingSchedulePressThreeTickets = printingTicketsGroupedBySubDepartment['SCHEDULE PRESS THREE'] %> <!-- TODO: This table is missing and therefore this variable is unused right now, ask storm about it -->
    <% const printingOnHoldTickets = printingTicketsGroupedBySubDepartment['ON HOLD'] %>

    <% const cuttingInProgressTickets = cuttingTicketsGroupedBySubDepartment['IN PROGRESS'] %>
    <% const cuttingReadyForSchedulingTickets = cuttingTicketsGroupedBySubDepartment['READY FOR SCHEDULING'] %>
    <% const cuttingScheduleDeltaOneTickets = cuttingTicketsGroupedBySubDepartment['SCHEDULE DELTA ONE'] %>
    <% const cuttingScheduleDeltaTwoTickets = cuttingTicketsGroupedBySubDepartment['SCHEDULE DELTA TWO'] %>
    <% const cuttingScheduleRotoflexTickets = cuttingTicketsGroupedBySubDepartment['SCHEDULE ROTOFLEX'] %>
    <% const cuttingOnHoldTickets = cuttingTicketsGroupedBySubDepartment['ON HOLD'] %>

    <% const windingInProgressTickets = windingTicketsGroupedBySubDepartment['IN PROGRESS'] %>
    <% const windingReadyForSchedulingTickets = windingTicketsGroupedBySubDepartment['READY FOR SCHEDULING'] %>
    <% const windingOnHoldTickets = windingTicketsGroupedBySubDepartment['ON HOLD'] %>

    <% const shippingInProgressTickets = shippingTicketsGroupedBySubDepartment['IN PROGRESS'] %>
    <% const shippingReadyForShippingTickets = shippingTicketsGroupedBySubDepartment['READY FOR SHIPPING'] %>
    <% const shippingOnHoldTickets = shippingTicketsGroupedBySubDepartment['ON HOLD'] %>
    <% const shippingToolArrivalTickets = shippingTicketsGroupedBySubDepartment['TOOL ARRIVALS'] %>

    <% const billingInProgressTickets = billingTicketsGroupedBySubDepartment['IN PROGRESS'] %> <!-- TODO: This table is missing and therefore this variable is unused right now, ask storm about it -->
    <% const billingReadyForBillingTickets = billingTicketsGroupedBySubDepartment['READY FOR BILLING'] %> <!-- TODO: This table is missing and therefore this variable is unused right now, ask storm about it -->


      <% if (orderPrepTicketsGroupedBySubDepartment && Object.keys(orderPrepTicketsGroupedBySubDepartment).length > 0) { %>
      <!-- Order Prep Department -->
      <div class='department-wrapper' data-department="ORDER-PREP">
        <h1>Order Prep Department</h1>
        <% if (orderPrepNeedsAttentionTickets && orderPrepNeedsAttentionTickets.length) { %>
        <div class='department-section department-section-e'>
          <div class='header flex-center-left-row'>
            <div class='expanded-options-wrapper'>
              <div class='expanded-options-btn flex-center-center-row'>
                <i class="fa-solid fa-caret-down"></i>
              </div>
              <div class='expanded-options-dropdown dropdown'>
                <ul>
                  <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                  <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                  <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                  <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                </ul>
              </div>
            </div>
            <h3 class='category-header text-purple'>Needs Attention - <span class='category-ticket-count'><%= orderPrepNeedsAttentionTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'></div>
              <div class='column-header column-header-h'>From</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div class='table-body flex-center-center-column'>
              <div class='table-row-wrapper full-width'>
              <% orderPrepNeedsAttentionTickets.forEach((ticket, index) => { %>
              <div class='table-row flex-center-center-column'>
                <div class='flex-center-center-row ticket-wrapper full-width'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <div class='ticket-dropdown-options dropdown'>
                      <ul>
                        <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                        <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                        <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                        <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                        <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                      </ul>
                    </div>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'>
                    <div class='user-cell bg-blue tooltip'>SV
                      <span class="tooltiptext">TODO</span>
                    </div><span class='machine-name'>Press 1 (TODO)</span>
                  </div>
                  <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                </div>
              </div>
              <% }) %>
              <div class='ticket-products-wrapper flex-center-right-column full-width'>
                <div class='table-header secondary-table-header flex-center-center-row'>
                  <div class='column-header column-header-a'></div>
                  <div class='column-header column-header-b'>#</div>
                  <div class='column-header column-header-c'>Products</div>
                  <div class='column-header column-header-d'></div>
                  <div class='column-header column-header-e'></div>
                  <div class='column-header column-header-f'></div>
                  <div class='column-header column-header-g'>Frames</div>
                  <div class='column-header column-header-h'>Quantity</div>
                  <div class='column-header column-header-i'>Artwork</div>
                </div>

                <!--Gavin this where you would loop through and display products that belong to a ticket -->
                <div class='product-wrapper flex-top-center-column'>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a bg-green'>
                      <i class='fa-light fa-ellipsis-vertical text-white'></i>
                      <div class='ticket-dropdown-options dropdown'>
                        <ul>
                          <li><i class="fa-regular fa-eye"></i>View Product</li>
                          <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                        </ul>
                      </div>
                    </div>
                    <div class='column-td column-td-b bg-white'>1</div>
                    <div class='column-td column-td-c product-number-column bg-white'>767D-001</div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'>100</div>
                    <div class='column-td column-td-h bg-white'>4000</div>
                    <div class='column-td column-td-i bg-white'><i class="fa-regular fa-image-polaroid"></i></div>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
      <% } %>

      <% if (orderPrepSendToCustomerTickets && orderPrepSendToCustomerTickets.length) { %>  <!-- TODO: This one is goofy, relook at the .each block -->
      <div class='department-section department-section-a'>
        <div class='header flex-center-left-row'>
          <div class='expanded-options-wrapper'>
            <div class='expanded-options-btn flex-center-center-row'>
              <i class="fa-solid fa-caret-down"></i>
            </div>
            <div class='expanded-options-dropdown dropdown'>
              <ul>
                <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
              </ul>
            </div>
          </div>
          <h3 class='category-header text-green'>Send To Customer - <span class='category-ticket-count'><%= orderPrepSendToCustomerTickets.length %></span></h3>
        </div>
        <div class='table ticket-container flex-top-center-column'>
          <div class='table-header flex-center-center-row'>
            <div class='column-header column-header-a'></div>
            <div class='column-header column-header-b'>#</div>
            <div class='column-header column-header-c'>Ticket Number</div>
            <div class='column-header column-header-d'>Status</div>
            <div class='column-header column-header-e'></div>
            <div class='column-header column-header-f'></div>
            <div class='column-header column-header-g'></div>
            <div class='column-header column-header-h'></div>
            <div class='column-header column-header-i'>Due Date</div>
          </div>
          <div class='table-body flex-center-center-column'>
            <% orderPrepSendToCustomerTickets.forEach((ticket, index) => { %>
              <div class='table-row flex-center-center-row'>
                <div class='column-td column-td-a'>
                  <i class='fa-light fa-ellipsis-vertical text-white'></i>
                  <div class='ticket-dropdown-options dropdown'>
                    <ul>
                      <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                      <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                      <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                      <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                      <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                    </ul>
                  </div>
                </div>
                <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                <div class='column-td column-td-d bg-purple text-white'>Rush</div>
                <div class='column-td column-td-e bg-white'></div>
                <div class='column-td column-td-f bg-white'></div>
                <div class='column-td column-td-g bg-white'></div>
                <div class='column-td column-td-h bg-white'></div>
                <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
              </div>
            <% }) %>
          </div>
        </div>
      </div>
      <% } %>

        <% if (orderPrepWaitingOnApprovalTickets && orderPrepWaitingOnApprovalTickets.length) { %>
          <div class='department-section department-section-b'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Waiting On Approval- <span class='category-ticket-count'><%= orderPrepWaitingOnApprovalTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'>Follow Up Date </div>
                <div class='column-header column-header-h'>Sent Date</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% orderPrepWaitingOnApprovalTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                      <i class='fa-light fa-ellipsis-vertical text-white'></i>
                      <div class='ticket-dropdown-options dropdown'>
                        <ul>
                          <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                          <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                        </ul>
                      </div>
                    </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'>July 2 (TODO)</div>
                    <div class='column-td column-td-h bg-white'>July 1 (TODO)</div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (orderPrepWaitingOnCustomerTickets && orderPrepWaitingOnCustomerTickets.length) { %>
          <div class='department-section department-section-c'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Waiting On Customer- <span class='category-ticket-count'><%= orderPrepWaitingOnCustomerTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'>Follow Up Date</div>
                <div class='column-header column-header-h'>Sent Date</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% orderPrepWaitingOnCustomerTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                      <i class='fa-light fa-ellipsis-vertical text-white'></i>
                      <div class='ticket-dropdown-options dropdown'>
                        <ul>
                          <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                          <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                        </ul>
                      </div>
                    </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'>July 2 (TODO)</div>
                    <div class='column-td column-td-h bg-white'>July 1 (TODO)</div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (orderPrepReadyToOrderTickets && orderPrepReadyToOrderTickets.length) { %>
          <div class='department-section department-section-d'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Ready To Order Plate / Die - <span class='category-ticket-count'><%= orderPrepReadyToOrderTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Type</div>
                <div class='column-header column-header-d'></div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'></div>
                <div class='column-header column-header-h'></div>
                <div class='column-header column-header-i'></div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% orderPrepReadyToOrderTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                      <i class='fa-light fa-ellipsis-vertical text-white'></i>
                      <div class='ticket-dropdown-options dropdown'>
                        <ul>
                          <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                          <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                        </ul>
                      </div>
                    </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>Plate (TODO)</div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'></div>
                    <div class='column-td column-td-h bg-white'></div>
                    <div class='column-td column-td-i bg-white'></div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

      </div>
    <% } %>

    <br>
    <br>
    <br>
    
    <% if (artPrepTicketsGroupedBySubDepartment && Object.keys(artPrepTicketsGroupedBySubDepartment).length > 0) { %>
      <!-- Art Department -->
      <div class='department-wrapper' data-department="ART-PREP">
        <h1>Art Department</h1>

        <% if (artPrepNeedsAttentionTickets && artPrepNeedsAttentionTickets.length) { %>
          <div class='department-section department-section-e'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Needs Attention - <span class='category-ticket-count'><%= artPrepNeedsAttentionTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'></div>
                <div class='column-header column-header-h'>From</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% artPrepNeedsAttentionTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'></div>
                    <div class='column-td column-td-h bg-white'>
                      <div class='user-cell bg-blue tooltip'>SV
                        <span class="tooltiptext">Storm Vaske (TODO)</span>
                      </div><span class='machine-name'>Press 1 (TODO)</span>
                    </div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (artPrepInProgressTickets && artPrepInProgressTickets.length) { %>
          <div class='department-section department-section-a'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-green'>In Progress - <span class='category-ticket-count'><%= artPrepInProgressTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'></div>
                <div class='column-header column-header-h'></div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% artPrepInProgressTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                      <i class='fa-light fa-ellipsis-vertical text-white'></i>
                      <div class='ticket-dropdown-options dropdown'>
                        <ul>
                          <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                        </ul>
                      </div>
                    </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-purple text-white'>Rush (TODO)</div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'></div>
                    <div class='column-td column-td-h bg-white'></div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (artPrepNeedsProofTickets && artPrepNeedsProofTickets.length) { %>
          <div class='department-section department-section-b'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Needs Proof - <span class='category-ticket-count'><%= artPrepNeedsProofTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'>Follow Up Date </div>
                <div class='column-header column-header-h'>Sent Date</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% artPrepNeedsProofTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'><i class="fa-light fa-ellipsis-vertical text-white"></i></div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'>July 2 (TODO)</div>
                    <div class='column-td column-td-h bg-white'>July 1 (TODO)</div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (artPrepNeedsDieLineTickets && artPrepNeedsDieLineTickets.length) { %>
          <div class='department-section department-section-c'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Needs Die Line - <span class='category-ticket-count'><%= artPrepNeedsDieLineTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'>Follow Up Date</div>
                <div class='column-header column-header-h'>Sent Date</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% artPrepNeedsDieLineTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %></div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'>July 2 (TODO)</div>
                    <div class='column-td column-td-h bg-white'>July 1 (TODO)</div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
          <% } %>

        <% if (artPrepNeedsPlateTickets && artPrepNeedsPlateTickets.length) { %>
          <div class='department-section department-section-d'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Needs Plate - <span class='category-ticket-count'><%= artPrepNeedsPlateTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Type</div>
                <div class='column-header column-header-d'></div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'></div>
                <div class='column-header column-header-h'></div>
                <div class='column-header column-header-i'></div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% artPrepNeedsPlateTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>Plate (TODO)</div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'></div>
                    <div class='column-td column-td-h bg-white'></div>
                    <div class='column-td column-td-i bg-white'></div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>
      </div>
    <% } %>

    <br>
    <br>
    <br>
  
    <% if (prePressTicketsGroupedBySubDepartment && Object.keys(prePressTicketsGroupedBySubDepartment).length > 0) { %>
      <!-- Pre Press Department-->
      <div class='department-wrapper' data-department="PRE-PRESS">
        <h1>Pre Pess Department</h1>

        <% if (prePressNeedsAttentionTickets && prePressNeedsAttentionTickets.length) { %>
          <div class='department-section department-section-e'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Needs Attention - <span class='category-ticket-count'><%= prePressNeedsAttentionTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'></div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% prePressNeedsAttentionTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %> </div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'></div>
                    <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (prePressInProgressTickets && prePressInProgressTickets.length) { %>  <!-- TODO: The row setup in this one is not like the rest - investigate -->
          <div class='department-section department-section-a'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-green'>In Progress - <span class='category-ticket-count'><%= prePressInProgressTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'></div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% prePressInProgressTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                      <i class='fa-light fa-ellipsis-vertical text-white'></i>
                      <div class='ticket-dropdown-options dropdown'>
                        <ul>
                          <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                        </ul>
                      </div>
                    </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-purple text-white'>Rush</div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'></div>
                    <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (prePressSendToPressTickets && prePressSendToPressTickets.length) { %>
          <div class='department-section department-section-b'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Send To Press - <span class='category-ticket-count'><%= prePressSendToPressTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'> </div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% prePressSendToPressTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'><i class="fa-light fa-ellipsis-vertical text-white"></i></div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %> </div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'></div>
                    <div class='column-td column-td-h bg-white'><%= ticket.products.length %></div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

      </div>
    <% } %>

    <br>
    <br>
    <br>

    <% if (printingTicketsGroupedBySubDepartment && Object.keys(printingTicketsGroupedBySubDepartment).length > 0) { %>
      <!-- Printing Department-->
      <div class='department-wrapper' data-department="PRINTING">
        <h1>Printing Department</h1>

        <% if (printingInProgressTickets && printingInProgressTickets.length) { %>  <!-- TODO: This .each looks unique - investigate -->
          <div class='department-section department-section-a'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-green'>In Progress - <span class='category-ticket-count'><%= printingInProgressTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'>Location</div>
                <div class='column-header column-header-f'>Length</div>
                <div class='column-header column-header-g'>Material</div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% printingInProgressTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                      <i class='fa-light fa-ellipsis-vertical text-white'></i>
                      <div class='ticket-dropdown-options dropdown'>
                        <ul>
                          <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                          <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                        </ul>
                      </div>
                    </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %> </div>
                    <div class='column-td column-td-d bg-purple text-white'>Rush</div>
                    <div class='column-td column-td-e bg-white'>
                      <div class='user-cell bg-blue tooltip'>SV
                        <span class="tooltiptext">Storm Vaske (TODO)</span>
                      </div><span class='machine-name'>Press 1 (TODO)</span>
                    </div>
                    <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                    <div class='column-td column-td-g bg-white'><%= ticket.primaryMaterial || 'N/A' %></div>
                    <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>
        
        <% if (printingReadyForSchedulingTickets && printingReadyForSchedulingTickets.length) { %>
          <div class='department-section department-section-b'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Ready For Scheduling- <span class='category-ticket-count'><%= printingReadyForSchedulingTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'>Length</div>
                <div class='column-header column-header-g'>Material</div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% printingReadyForSchedulingTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %></div>
                    <div class='column-td column-td-d bg-red text-white'>Hot (TODO)</div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                    <div class='column-td column-td-g bg-white'><%= ticket.primaryMaterial || 'N/A' %></div>
                    <div class='column-td column-td-h bg-white'><%= ticket.products.length %></div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (printingSchedulePressOneTickets && printingSchedulePressOneTickets.length) { %>
          <div class='department-section department-section-c'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Scheduled Press One - <span class='category-ticket-count'><%= printingSchedulePressOneTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'>Length</div>
                <div class='column-header column-header-g'>Material</div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% printingSchedulePressOneTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-red text-white'>Hot (TODO)</div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                    <div class='column-td column-td-g bg-white'><%= ticket.primaryMaterial || 'N/A' %></div>
                    <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (printingSchedulePressTwoTickets && printingSchedulePressTwoTickets.length) { %>  <!-- TODO: This .each looks unique - investigate -->
          <div class='department-section department-section-d'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Scheduled Press Two - <span class='category-ticket-count'><%= printingSchedulePressTwoTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'>Length</div>
                <div class='column-header column-header-g'>Material</div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% printingSchedulePressTwoTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %> </div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                    <div class='column-td column-td-g bg-white'><%= ticket.primaryMaterial || 'N/A' %></div>
                    <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (printingOnHoldTickets && printingOnHoldTickets.length) { %>
          <div class='department-section department-section-e'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>On Hold - <span class='category-ticket-count'><%= printingOnHoldTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'>Hold Status</div>
                <div class='column-header column-header-f'>Length</div>
                <div class='column-header column-header-g'>Material</div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% printingOnHoldTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %> </div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                    <div class='column-td column-td-g bg-white'><%= ticket.primaryMaterial || 'N/A' %></div>
                    <div class='column-td column-td-h bg-white'><%= ticket.products.length %></div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>
      </div>
    <% } %>
    
    
    <br>
    <br>
    <br>
    
    <% if (cuttingTicketsGroupedBySubDepartment && Object.keys(cuttingTicketsGroupedBySubDepartment).length > 0) { %>
      <!-- Cutting Department -->
      <div class='department-wrapper' data-department="CUTTING">
        <h1>Cutting Department</h1>

        <% if (cuttingInProgressTickets && cuttingInProgressTickets.length) { %>
          <div class='department-section department-section-a'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-green'>In Progress - <span class='category-ticket-count'><%= cuttingInProgressTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'>Location</div>
                <div class='column-header column-header-f'>Die</div>
                <div class='column-header column-header-g'>Length</div>
                <div class='column-header column-header-h'>Finish</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% cuttingInProgressTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                      <i class='fa-light fa-ellipsis-vertical text-white'></i>
                      <div class='ticket-dropdown-options dropdown'>
                        <ul>
                          <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                          <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                        </ul>
                      </div>
                    </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-purple text-white'>Rush (TODO)</div>
                    <div class='column-td column-td-e bg-white'>
                      <div class='user-cell bg-blue tooltip'>SV
                        <span class="tooltiptext">Storm Vaske (TODO)</span>
                      </div><span class='machine-name'>Press 1 (TODO)</span>
                    </div>
                    <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                    <div class='column-td column-td-g bg-white'>9111 (TODO)</div>
                    <div class='column-td column-td-h bg-white'>4 (TODO)</div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (cuttingReadyForSchedulingTickets && cuttingReadyForSchedulingTickets.length) { %>
          <div class='department-section department-section-b'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Ready For Scheduling- <span class='category-ticket-count'><%= cuttingReadyForSchedulingTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'>Die</div>
                <div class='column-header column-header-g'>Length</div>
                <div class='column-header column-header-h'>Finish</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% cuttingReadyForSchedulingTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %></div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                    <div class='column-td column-td-g bg-white'>9111 (TODO)</div>
                    <div class='column-td column-td-h bg-white'>4 (TODO)</div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (cuttingScheduleDeltaOneTickets && cuttingScheduleDeltaOneTickets.length) { %>
          <div class='department-section department-section-c'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Scheduled Delta One - <span class='category-ticket-count'><%= cuttingScheduleDeltaOneTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'>Die</div>
                <div class='column-header column-header-g'>Length</div>
                <div class='column-header column-header-h'>Finish</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% cuttingScheduleDeltaOneTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %></div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                    <div class='column-td column-td-g bg-white'>9111 (TODO)</div>
                    <div class='column-td column-td-h bg-white'>4 (TODO)</div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (cuttingScheduleDeltaTwoTickets && cuttingScheduleDeltaTwoTickets.length) { %>
          <div class='department-section department-section-d'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Scheduled Delta Two - <span class='category-ticket-count'><%= cuttingScheduleDeltaTwoTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'>Die</div>
                <div class='column-header column-header-g'>Length</div>
                <div class='column-header column-header-h'>Finish</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% cuttingScheduleDeltaTwoTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %> </div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                    <div class='column-td column-td-g bg-white'>9111 (TODO)</div>
                    <div class='column-td column-td-h bg-white'>4 (TODO)</div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (cuttingScheduleRotoflexTickets && cuttingScheduleRotoflexTickets.length) { %>
          <div class='department-section department-section-f'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Scheduled Rofoflex - <span class='category-ticket-count'><%= cuttingScheduleRotoflexTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'>Length</div>
                <div class='column-header column-header-g'>Material</div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% cuttingScheduleRotoflexTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %></div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                    <div class='column-td column-td-g bg-white'>9111 (TODO)</div>
                    <div class='column-td column-td-h bg-white'>4 (TODO)</div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (cuttingOnHoldTickets && cuttingOnHoldTickets.length) { %>
          <div class='department-section department-section-e'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>On Hold - <span class='category-ticket-count'><%= cuttingOnHoldTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'>Hold Status</div>
                <div class='column-header column-header-f'>Die</div>
                <div class='column-header column-header-g'>Length</div>
                <div class='column-header column-header-h'>Finish</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% cuttingOnHoldTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %> </div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                    <div class='column-td column-td-g bg-white'>9111 (TODO)</div>
                    <div class='column-td column-td-h bg-white'>4 (TODO)</div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>
      </div>
    <% } %>

    <br>
    <br>
    <br>

    <% if (windingTicketsGroupedBySubDepartment && Object.keys(windingTicketsGroupedBySubDepartment).length > 0) { %>
      <!-- Winding Department -->
      <div class='department-wrapper' data-department="WINDING">
        <h1>Winding Department</h1>

        <% if (windingInProgressTickets && windingInProgressTickets.length) { %>
          <div class='department-section department-section-a'> <!-- TODO: This .each Looks different -->
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-green'>In Progress - <span class='category-ticket-count'><%= windingInProgressTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'>Location</div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'>Rolls</div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% windingInProgressTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                      <i class='fa-light fa-ellipsis-vertical text-white'></i>
                      <div class='ticket-dropdown-options dropdown'>
                        <ul>
                          <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                          <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                        </ul>
                      </div>
                    </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-purple text-white'>Rush (TODO)</div>
                    <div class='column-td column-td-e bg-white'>
                      <div class='user-cell bg-blue tooltip'>SV
                        <span class="tooltiptext">Storm Vaske (TODO)</span>
                      </div><span class='machine-name'>Press 1 (TODO)</span>
                    </div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'>18 (TODO)</div>
                    <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (windingReadyForSchedulingTickets && windingReadyForSchedulingTickets.length) { %>
          <div class='department-section department-section-b'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Ready For Scheduling - <span class='category-ticket-count'><%= windingReadyForSchedulingTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'>Location</div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'>Rolls</div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% windingReadyForSchedulingTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                      <i class='fa-light fa-ellipsis-vertical text-white'></i>
                      <div class='ticket-dropdown-options dropdown'>
                        <ul>
                          <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                          <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                        </ul>
                      </div>
                    </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'>24 (TODO)</div>
                    <div class='column-td column-td-h bg-white'>3 <%= ticket.products.length %> </div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (windingOnHoldTickets && windingOnHoldTickets.length) { %>
          <div class='department-section department-section-e'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>On Hold - <span class='category-ticket-count'><%= windingOnHoldTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'>Location</div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'>Rolls</div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% windingOnHoldTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'>3 (TODO)</div>
                    <div class='column-td column-td-h bg-white'><%= ticket.products.length %></div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>
      </div>
    <% } %>
  
    <br>
    <br>
    <br>

    <% if (shippingTicketsGroupedBySubDepartment && Object.keys(shippingTicketsGroupedBySubDepartment).length > 0) { %>
      <!-- Shipping Department -->
      <div class='department-wrapper' data-department="SHIPPING">
        <h1>Shipping Department</h1>

        <% if (shippingInProgressTickets && shippingInProgressTickets.length) { %>
          <div class='department-section department-section-a'> <!-- TODO: This .each is unique? why -->
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-green'>In Progress - <span class='category-ticket-count'><%= shippingInProgressTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'>Grouped</div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% shippingInProgressTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                      <i class='fa-light fa-ellipsis-vertical text-white'></i>
                      <div class='ticket-dropdown-options dropdown'>
                        <ul>
                          <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                          <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                        </ul>
                      </div>
                    </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-purple text-white'>Rush (TODO)</div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'></div>
                    <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (shippingReadyForShippingTickets && shippingReadyForShippingTickets.length) { %>
          <div class='department-section department-section-b'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Ready For Shipping - <span class='category-ticket-count'><%= shippingReadyForShippingTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'>Grouped</div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% shippingReadyForShippingTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                      <i class='fa-light fa-ellipsis-vertical text-white'></i>
                      <div class='ticket-dropdown-options dropdown'>
                        <ul>
                          <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                          <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                          <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                        </ul>
                      </div>
                    </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'></div>
                    <div class='column-td column-td-h bg-white'><%= ticket.products.length %></div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (shippingOnHoldTickets && shippingOnHoldTickets.length) { %>
          <div class='department-section department-section-e'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>On Hold - <span class='category-ticket-count'><%= shippingOnHoldTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'>Grouped</div>
                <div class='column-header column-header-h'>Products</div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% shippingOnHoldTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'></div>
                    <div class='column-td column-td-h bg-white'><%= ticket.products.length %></div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>

        <% if (shippingToolArrivalTickets && shippingToolArrivalTickets.length) { %>
          <div class='department-section department-section-c'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-purple'>Arrival Plate / Die - <span class='category-ticket-count'><%= shippingToolArrivalTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Type</div>
                <div class='column-header column-header-d'>Status</div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'></div>
                <div class='column-header column-header-h'></div>
                <div class='column-header column-header-i'>Arrival Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <% shippingToolArrivalTickets.forEach((ticket, index) => { %>
                  <div class='table-row flex-center-center-row'>
                    <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>Plate (TODO)</div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'></div>
                    <div class='column-td column-td-h bg-white'></div>
                    <div class='column-td column-td-i bg-white'>July 4 (TODO)</div>
                  </div>
                <% }) %>
              </div>
            </div>
          </div>
        <% } %>
      </div>
    <% } %>

    <br>
    <br>
    <br>
  
    <% if (billingTicketsGroupedBySubDepartment && Object.keys(billingTicketsGroupedBySubDepartment).length > 0) { %>
      <!-- Billing Department -->
      <div class='department-wrapper' data-department="BILLING">
        <h1>Billing Department (TODO Storm: this second's subdepartments appear incorrect)</h1>

        <% if (true) { %>  <!-- TODO: This section is an invalid billing section, storm needs to update it -->
          <div class='department-section department-section-a'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                    <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                    <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-green'>Ready For Processing - <span class='category-ticket-count'>2</span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'></div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'></div>
                <div class='column-header column-header-h'></div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div class='table-body flex-center-center-column'>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <div class='ticket-dropdown-options dropdown'>
                      <ul>
                        <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                        <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                        <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                        <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                        <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                      </ul>
                    </div>
                  </div>
                  <div class='column-td column-td-b bg-white'>1</div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#47001</div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'></div>
                  <div class='column-td column-td-i bg-white'>July 4</div>
                </div>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <li><i class="fa-regular fa-eye"></i>View Ticket</li>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                            <li><i class="fa-regular fa-file-excel"></i>Export to Excel</li>
                          </ul>
                        </div>
                      </div>
                  <div class='column-td column-td-b bg-white'>1</div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#47001</div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'></div>
                  <div class='column-td column-td-i bg-white'>July 4</div>  
                </div>
              </div>
            </div>
          </div>
        <% } %>
      </div>
    <% } %>

  </div>
</div>