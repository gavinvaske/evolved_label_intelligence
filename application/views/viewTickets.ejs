<script>
  var bodyclass=document.createAttribute("class");
  bodyclass.value="view-tickets-body";
  document.getElementsByTagName("body")[0].setAttributeNode(bodyclass);
</script>
<div class="page-wrapper view-tickets">
  <%- include('partials/navbarMain.ejs') %>
  <%- include('partials/sidebarMain.ejs') %>
  <div class='tickets-card'>
    <div class='workflow-order-header card'>
      
      <div class='header-description'>
        <h1 class=''>Order Workflow <span class='text-blue' id="department-select"> - All Departments</span></h1>
        <!-- <p>All jobs tickets can be found in the departments below.</p> -->
      </div>
      <div class="alert-box full-width">
          <%- include ("flashMessages") %>
      </div>
      <div class='workflow-navigation'>
        <ul class='navigation-list full-width'>
          <li data-department="ORDER-PREP">Order Prep</li>
          <li data-department="ART-PREP">Art Prep</li>
          <li data-department="PRE-PRESS">Pre-Printing</li>
          <li data-department="PRINTING">Printing</li>
          <li data-department="CUTTING">Cutting</li>
          <li data-department="WINDING">Winding</li>
          <li data-department="SHIPPING">Shipping</li>
          <li data-department="BILLING">Billing</li>
        </ul>

      </div>
      <div class='workflow-filter flex-center-left-row'>

        <a href='/tickets/upload' class='create bg-blue text-white border-blue btn-create'>Create <i class="fa-regular fa-plus"></i></a>

        <div class='search-wrapper flex-center-left-row'>
          <i class="fa-regular fa-magnifying-glass flex-center-center-row"></i><input placeholder='Search' value='' class='search-input'>
        </div>

        <div class='person-filter-wrapper tooltip'>
          <button class='filter btn-person-filter'>
            <span class="tooltiptext">Filter by person</span>
            <i class='fa-regular fa-circle-user'></i> Person
          </button>
          <div class='person-filter-dropdown dropdown'>
            <h5><b>Quick person filter</b></h5>
            <p>Filter items and subitems by person.</p>
          </div>
        </div>

        <div class='split-btn-frame btn-filter flex-center-center-row tooltip'>
          <span class="tooltiptext">Filter by anything</span>
          <div class='filter-btn-wrapper flex-center-center-row'>
            <button class='btn-split quick-filter flex-center-center-row'>
              <i class="fa-light fa-filter"></i>Filter
            </button>
            <button class='btn-split-arrow-dropdown btn-advanced-filter'><i class="fa-regular fa-chevron-down"></i></button>
          </div>

          <div class='quick-filter-dropdown dropdown'>
            <h5><b>Quick Filter</b></h5>
            <p>Testing how big the dropdown box can be</p>
          </div>

          <div class='advanced-filter-dropdown dropdown'>
            <h5><b>Advanced Filter</b></h5>
            <p>Testing how big the dropdown box can be</p>
          </div>
        </div>

        <div class='sort-wrapper tooltip'>
          <span class="tooltiptext">Sort by any column</span>
          <button class='sort btn-sort'><i class="fa-regular fa-arrow-down-arrow-up"></i> Sort</button>
          <div class='sort-dropdown dropdown'>
            <h5><b>Sort by</b></h5>
            <p>Testing how big the dropdown box can be</p>
          </div>
        </div>

        <div class='all-wrapper tooltip'>
          <a href="/tickets">
            <span class="tooltiptext">See All</span>
            <button class='sort btn-sort' href="/tickets"><i class="fa-solid fa-layer-group"></i> See All</button>
          </a>
        </div>

      </div>

    </div>

    <div class='scroll-curtain'></div>

    <% const orderPrepTicketsGroupedByDepartmentStatus = ticketsGroupedByDestination['ORDER-PREP'] %>
    <% const artPrepTicketsGroupedByDepartmentStatus = ticketsGroupedByDestination['ART-PREP'] %>
    <% const prePressTicketsGroupedByDepartmentStatus = ticketsGroupedByDestination['PRE-PRESS'] %>
    <% const printingTicketsGroupedByDepartmentStatus = ticketsGroupedByDestination['PRINTING'] %>
    <% const cuttingTicketsGroupedByDepartmentStatus = ticketsGroupedByDestination['CUTTING'] %>
    <% const windingTicketsGroupedByDepartmentStatus = ticketsGroupedByDestination['WINDING'] %>
    <% const shippingTicketsGroupedByDepartmentStatus = ticketsGroupedByDestination['SHIPPING'] %>
    <% const billingTicketsGroupedByDepartmentStatus = ticketsGroupedByDestination['BILLING'] %>

    <% const orderPrepNeedsAttentionTickets = orderPrepTicketsGroupedByDepartmentStatus['NEEDS ATTENTION'] %>
    <% const orderPrepSendToCustomerTickets = orderPrepTicketsGroupedByDepartmentStatus['SEND TO CUSTOMER'] %>
    <% const orderPrepWaitingOnApprovalTickets = orderPrepTicketsGroupedByDepartmentStatus['WAITING ON APPROVAL'] %>
    <% const orderPrepWaitingOnCustomerTickets = orderPrepTicketsGroupedByDepartmentStatus['WAITING ON CUSTOMER'] %>
    <% const orderPrepReadyToOrderTickets = orderPrepTicketsGroupedByDepartmentStatus['READY TO ORDER PLATE OR DIE'] %>
    <% const orderPrepInProgressTickets = orderPrepTicketsGroupedByDepartmentStatus['IN PROGRESS'] %>

    <% const artPrepNeedsAttentionTickets = artPrepTicketsGroupedByDepartmentStatus['NEEDS ATTENTION'] %>
    <% const artPrepInProgressTickets = artPrepTicketsGroupedByDepartmentStatus['IN PROGRESS'] %>
    <% const artPrepNeedsProofTickets = artPrepTicketsGroupedByDepartmentStatus['NEEDS PROOF'] %>
    <% const artPrepNeedsDieLineTickets = artPrepTicketsGroupedByDepartmentStatus['NEEDS DIE LINE'] %>
    <% const artPrepNeedsPlateTickets = artPrepTicketsGroupedByDepartmentStatus['NEEDS PLATE'] %>

    <% const prePressNeedsAttentionTickets = prePressTicketsGroupedByDepartmentStatus['NEEDS ATTENTION'] %>
    <% const prePressInProgressTickets = prePressTicketsGroupedByDepartmentStatus['IN PROGRESS'] %>
    <% const prePressSendToPressTickets = prePressTicketsGroupedByDepartmentStatus['SEND TO PRESS'] %>
  
    <% const printingInProgressTickets = [
        ...printingTicketsGroupedByDepartmentStatus['SET-UP'],
        ...printingTicketsGroupedByDepartmentStatus['RUNTIME'],
        ...printingTicketsGroupedByDepartmentStatus['TEAR-DOWN']
      ]
    %>
    <% const printingReadyForSchedulingTickets = printingTicketsGroupedByDepartmentStatus['READY FOR SCHEDULING'] %>
    <% const printingSchedulePressOneTickets = printingTicketsGroupedByDepartmentStatus['SCHEDULE PRESS ONE'] %>
    <% const printingSchedulePressTwoTickets = printingTicketsGroupedByDepartmentStatus['SCHEDULE PRESS TWO'] %>
    <% const printingSchedulePressThreeTickets = printingTicketsGroupedByDepartmentStatus['SCHEDULE PRESS THREE'] %>
    <% const printingOnHoldTickets = printingTicketsGroupedByDepartmentStatus['ON HOLD'] %>

    <% const cuttingInProgressTickets = [
        ...cuttingTicketsGroupedByDepartmentStatus['SET-UP'],
        ...cuttingTicketsGroupedByDepartmentStatus['RUNTIME'],
        ...cuttingTicketsGroupedByDepartmentStatus['TEAR-DOWN']
      ]
    %>
    <% const cuttingReadyForSchedulingTickets = cuttingTicketsGroupedByDepartmentStatus['READY FOR SCHEDULING'] %>
    <% const cuttingScheduleDeltaOneTickets = cuttingTicketsGroupedByDepartmentStatus['SCHEDULE DELTA ONE'] %>
    <% const cuttingScheduleDeltaTwoTickets = cuttingTicketsGroupedByDepartmentStatus['SCHEDULE DELTA TWO'] %>
    <% const cuttingScheduleRotoflexTickets = cuttingTicketsGroupedByDepartmentStatus['SCHEDULE ROTOFLEX'] %>
    <% const cuttingOnHoldTickets = cuttingTicketsGroupedByDepartmentStatus['ON HOLD'] %>

    <% const windingInProgressTickets = windingTicketsGroupedByDepartmentStatus['IN PROGRESS'] %>
    <% const windingReadyForSchedulingTickets = windingTicketsGroupedByDepartmentStatus['READY FOR SCHEDULING'] %>
    <% const windingOnHoldTickets = windingTicketsGroupedByDepartmentStatus['ON HOLD'] %>

    <% const shippingInProgressTickets = shippingTicketsGroupedByDepartmentStatus['IN PROGRESS'] %>
    <% const shippingReadyForShippingTickets = shippingTicketsGroupedByDepartmentStatus['READY FOR SHIPPING'] %>
    <% const shippingOnHoldTickets = shippingTicketsGroupedByDepartmentStatus['ON HOLD'] %>
    <% const shippingToolArrivalTickets = shippingTicketsGroupedByDepartmentStatus['TOOL ARRIVALS'] %>

    <% const billingReadyForBillingTickets = billingTicketsGroupedByDepartmentStatus['READY FOR BILLING'] %>
    <% const billingInProgressTickets = billingTicketsGroupedByDepartmentStatus['IN PROGRESS'] %>
    
      <% const numberOfOrderPrepTickets = Object.values(orderPrepTicketsGroupedByDepartmentStatus).flat().length %>
      <!-- Order Prep Department -->
      <div class='department-wrapper card' data-department="ORDER-PREP">
        <h4 class='department-name'>Order Prep - <span class='text-blue' id='departmentTotalTickets'><%= numberOfOrderPrepTickets %></span></h4>
        <div class='department-section department-section-e'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Needs Attention - <span class='category-ticket-count'><%= orderPrepNeedsAttentionTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'></div>
              <div class='column-header column-header-h'>From</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='order-prep-needs-attention-table' class='table-body flex-center-center-column'>
              <% orderPrepNeedsAttentionTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width order-prep-needs-attention-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-column'>
                  <div class='flex-center-center-row ticket-wrapper full-width'>
                    <div class='column-td column-td-a bg-green'>
                      <i class='fa-light fa-ellipsis-vertical text-white'></i>
                      <%- include('partials/ticket-dropdown-options.ejs', {
                        ticket: ticket
                        }
                    ) %>
                    </div>
                    <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                    <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                    <div class='column-td column-td-d bg-white'></div>
                    <div class='column-td column-td-e bg-white'></div>
                    <div class='column-td column-td-f bg-white'></div>
                    <div class='column-td column-td-g bg-white'></div>
                    <div class='column-td column-td-h bg-white'>
                      <div class='user-cell bg-blue tooltip'>SV
                        <span class="tooltiptext">TODO</span>
                      </div><span class='machine-name'>Press 1</span>
                    </div>
                    <div class='column-td column-td-i bg-white due-date-preview'>July 4</div>
                  </div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-a'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-green'>Send To Customer - <span class='category-ticket-count'><%= orderPrepSendToCustomerTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'></div>
              <div class='column-header column-header-h'></div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='order-prep-send-to-customer-table' class='table-body flex-center-center-column'>
              <% orderPrepSendToCustomerTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width order-prep-send-to-customer-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-purple text-white'>Rush</div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'></div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-b'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Waiting On Approval- <span class='category-ticket-count'><%= orderPrepWaitingOnApprovalTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'>Follow Up Date </div>
              <div class='column-header column-header-h'>Sent Date</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='order-prep-waiting-on-approval-table' class='table-body flex-center-center-column'>
              <% orderPrepWaitingOnApprovalTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width order-prep-waiting-on-approval-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'>July 2 (TODO)</div>
                  <div class='column-td column-td-h bg-white'>July 1 (TODO)</div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-c'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Waiting On Customer- <span class='category-ticket-count'><%= orderPrepWaitingOnCustomerTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'>Follow Up Date</div>
              <div class='column-header column-header-h'>Sent Date</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='order-prep-waiting-on-customer-table' class='table-body flex-center-center-column'>
              <% orderPrepWaitingOnCustomerTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width order-prep-waiting-on-customer-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'>July 2 (TODO)</div>
                  <div class='column-td column-td-h bg-white'>July 1 (TODO)</div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-d'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Ready To Order Plate / Die - <span class='category-ticket-count'><%= orderPrepReadyToOrderTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Type</div>
              <div class='column-header column-header-d'></div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'></div>
              <div class='column-header column-header-h'></div>
              <div class='column-header column-header-i'></div>
            </div>
            <div id='order-prep-ready-to-order-table' class='table-body flex-center-center-column'>
              <% orderPrepReadyToOrderTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width order-prep-ready-to-order-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>Plate (TODO)</div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'></div>
                  <div class='column-td column-td-i bg-white'></div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-d'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>In Progress - <span class='category-ticket-count'><%= orderPrepInProgressTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Type</div>
              <div class='column-header column-header-d'></div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'></div>
              <div class='column-header column-header-h'></div>
              <div class='column-header column-header-i'></div>
            </div>
            <div id='order-prep-in-progress-table' class='table-body flex-center-center-column'>
              <% orderPrepInProgressTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width order-prep-in-progress-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>Plate (TODO)</div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'></div>
                  <div class='column-td column-td-i bg-white'></div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>
      </div>

      <div class="department-end-frame flex-center-center-row full-width">
        <div class="department-divide-line"></div><h4>End Order Prep</h4><div class="department-divide-line"></div>
      </div>
      
      <!--- Art Prep Department Start-->
      <% const numberOfArtPrepTickets = Object.values(artPrepTicketsGroupedByDepartmentStatus).flat().length %>
      <!-- Art Department -->
      <div class='department-wrapper card' data-department="ART-PREP">
        <h4 class='department-name'>Art Prep - <span class='text-blue' id='departmentTotalTickets'><%= numberOfArtPrepTickets %></span></h4>

        <div class='department-section department-section-e'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Needs Attention - <span class='category-ticket-count'><%= artPrepNeedsAttentionTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'></div>
              <div class='column-header column-header-h'>From</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='art-prep-needs-attention-table' class='table-body flex-center-center-column'>
              <% artPrepNeedsAttentionTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width art-prep-needs-attention-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'>
                    <div class='user-cell bg-blue tooltip'>SV
                      <span class="tooltiptext">Storm Vaske (TODO)</span>
                    </div><span class='machine-name'>Press 1 (TODO)</span>
                  </div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-a'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-green'>In Progress - <span class='category-ticket-count'><%= artPrepInProgressTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'></div>
              <div class='column-header column-header-h'></div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='art-prep-in-progress-table' class='table-body flex-center-center-column'>
              <% artPrepInProgressTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width art-prep-in-progress-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-purple text-white'>Rush (TODO)</div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'></div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-b'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Needs Proof - <span class='category-ticket-count'><%= artPrepNeedsProofTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'>Follow Up Date </div>
              <div class='column-header column-header-h'>Sent Date</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='art-prep-needs-proof-table' class='table-body flex-center-center-column'>
              <% artPrepNeedsProofTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width art-prep-needs-proof-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'>July 2 (TODO)</div>
                  <div class='column-td column-td-h bg-white'>July 1 (TODO)</div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-c'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Needs Die Line - <span class='category-ticket-count'><%= artPrepNeedsDieLineTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'>Follow Up Date</div>
              <div class='column-header column-header-h'>Sent Date</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='art-prep-needs-die-table' class='table-body flex-center-center-column'>
              <% artPrepNeedsDieLineTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width art-prep-needs-die-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %></div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'>July 2 (TODO)</div>
                  <div class='column-td column-td-h bg-white'>July 1 (TODO)</div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-d'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Needs Plate - <span class='category-ticket-count'><%= artPrepNeedsPlateTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Type</div>
              <div class='column-header column-header-d'></div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'></div>
              <div class='column-header column-header-h'></div>
              <div class='column-header column-header-i'></div>
            </div>
            <div id='art-prep-needs-plate-table' class='table-body flex-center-center-column'>
              <% artPrepNeedsPlateTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width art-prep-needs-plate-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>Plate (TODO)</div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'></div>
                  <div class='column-td column-td-i bg-white'></div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>
      </div>

      <div class="department-end-frame flex-center-center-row full-width">
        <div class="department-divide-line"></div><h4>End Art Prep</h4><div class="department-divide-line"></div>
      </div>
  
      <% const numberOfPrePressTickets = Object.values(prePressTicketsGroupedByDepartmentStatus).flat().length %>
      <!-- Pre Press Department-->
      <div class='department-wrapper card' data-department="PRE-PRESS">
        <h4 class='department-name'>Pre-Printing - <span class='text-blue' id='departmentTotalTickets'><%= numberOfPrePressTickets %></span></h4>

        <div class='department-section department-section-e'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Needs Attention - <span class='category-ticket-count'><%= prePressNeedsAttentionTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'></div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='pre-press-needs-attention-table' class='table-body flex-center-center-column'>
              <% prePressNeedsAttentionTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width pre-press-needs-attention-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %> </div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-a'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-green'>In Progress - <span class='category-ticket-count'><%= prePressInProgressTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'></div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='pre-press-in-progress-table' class='table-body flex-center-center-column'>
              <% prePressInProgressTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width pre-press-in-progress-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-purple text-white'>Rush</div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-b'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Send To Press - <span class='category-ticket-count'><%= prePressSendToPressTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'> </div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='pre-press-send-to-press-table' class='table-body flex-center-center-column'>
              <% prePressSendToPressTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width pre-press-send-to-press-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %> </div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %></div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>
      </div>

      <div class="department-end-frame flex-center-center-row full-width">
        <div class="department-divide-line"></div><h4>End Pre Printing</h4><div class="department-divide-line"></div>
      </div>

      <% const numberOfPrintingTickets = Object.values(printingTicketsGroupedByDepartmentStatus).flat().length %>
      <!-- Printing Department-->
      <div class='department-wrapper card' data-department="PRINTING">
        <h4 class='department-name'>Printing - <span class='text-blue' id='departmentTotalTickets'><%= numberOfPrintingTickets %></span></h4>

        <div class='department-section department-section-a'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-green'>In Progress - <span class='category-ticket-count'><%= printingInProgressTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'>Location</div>
              <div class='column-header column-header-f'>Length</div>
              <div class='column-header column-header-g'>Material</div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='printing-in-progress-table' class='table-body flex-center-center-column'>
              <% printingInProgressTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width printing-in-progress-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %> </div>
                  <div class='column-td column-td-d bg-purple text-white'>Rush</div>
                  <div class='column-td column-td-e bg-white'>
                    <div class='user-cell bg-blue tooltip'>SV
                      <span class="tooltiptext">Storm Vaske (TODO)</span>
                    </div><span class='machine-name'>Press 1 (TODO)</span>
                  </div>
                  <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                  <div class='column-td column-td-g bg-white'><%= ticket.primaryMaterial || 'N/A' %></div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>
        
        <div class='department-section department-section-b'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Ready For Scheduling- <span class='category-ticket-count'><%= printingReadyForSchedulingTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'>Length</div>
              <div class='column-header column-header-g'>Material</div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='printing-ready-for-scheduling-table' class='table-body flex-center-center-column'>
              <% printingReadyForSchedulingTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width printing-ready-for-scheduling-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %></div>
                  <div class='column-td column-td-d bg-red text-white'>Hot (TODO)</div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                  <div class='column-td column-td-g bg-white'><%= ticket.primaryMaterial || 'N/A' %></div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %></div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-c'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Scheduled Press One - <span class='category-ticket-count'><%= printingSchedulePressOneTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'>Length</div>
              <div class='column-header column-header-g'>Material</div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='printing-schedule-press-one' class='table-body flex-center-center-column'>
              <% printingSchedulePressOneTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width printing-schedule-press-one-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-red text-white'>Hot (TODO)</div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                  <div class='column-td column-td-g bg-white'><%= ticket.primaryMaterial || 'N/A' %></div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-d'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Scheduled Press Two - <span class='category-ticket-count'><%= printingSchedulePressTwoTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'>Length</div>
              <div class='column-header column-header-g'>Material</div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='printing-schedule-press-two-table' class='table-body flex-center-center-column'>
              <% printingSchedulePressTwoTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width printing-schedule-press-two-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %> </div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                  <div class='column-td column-td-g bg-white'><%= ticket.primaryMaterial || 'N/A' %></div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-d'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Scheduled Press Three - <span class='category-ticket-count'><%= printingSchedulePressThreeTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'>Length</div>
              <div class='column-header column-header-g'>Material</div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='printing-schedule-press-three-table' class='table-body flex-center-center-column'>
              <% printingSchedulePressThreeTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width printing-schedule-press-three-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %> </div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                  <div class='column-td column-td-g bg-white'><%= ticket.primaryMaterial || 'N/A' %></div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-e'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>On Hold - <span class='category-ticket-count'><%= printingOnHoldTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'>Hold Status</div>
              <div class='column-header column-header-f'>Length</div>
              <div class='column-header column-header-g'>Material</div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='printing-on-hold-table' class='table-body flex-center-center-column'>
              <% printingOnHoldTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width printing-on-hold-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %> </div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                  <div class='column-td column-td-g bg-white'><%= ticket.primaryMaterial || 'N/A' %></div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %></div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>
      </div>

      <div class="department-end-frame flex-center-center-row full-width">
        <div class="department-divide-line"></div><h4>End Printing</h4><div class="department-divide-line"></div>
      </div>
    
      <% const numberOfCuttingTickets = Object.values(cuttingTicketsGroupedByDepartmentStatus).flat().length %>
      <!-- Cutting Department -->
      <div class='department-wrapper card' data-department="CUTTING">
        <h4 class='department-name'>Cutting - <span class='text-blue' id='departmentTotalTickets'><%= numberOfCuttingTickets %></span></h4>

        <div class='department-section department-section-a'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-green'>In Progress - <span class='category-ticket-count'><%= cuttingInProgressTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'>Location</div>
              <div class='column-header column-header-f'>Die</div>
              <div class='column-header column-header-g'>Length</div>
              <div class='column-header column-header-h'>Finish</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='cutting-in-progress-table' class='table-body flex-center-center-column'>
              <% cuttingInProgressTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width cutting-in-progress-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-purple text-white'>Rush (TODO)</div>
                  <div class='column-td column-td-e bg-white'>
                    <div class='user-cell bg-blue tooltip'>SV
                      <span class="tooltiptext">Storm Vaske (TODO)</span>
                    </div><span class='machine-name'>Press 1 (TODO)</span>
                  </div>
                  <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                  <div class='column-td column-td-g bg-white'>9111 (TODO)</div>
                  <div class='column-td column-td-h bg-white'>4 (TODO)</div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-b'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Ready For Scheduling- <span class='category-ticket-count'><%= cuttingReadyForSchedulingTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'>Die</div>
              <div class='column-header column-header-g'>Length</div>
              <div class='column-header column-header-h'>Finish</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='cutting-ready-for-scheduling-table' class='table-body flex-center-center-column'>
              <% cuttingReadyForSchedulingTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width cutting-ready-for-scheduling-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %></div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                  <div class='column-td column-td-g bg-white'>9111 (TODO)</div>
                  <div class='column-td column-td-h bg-white'>4 (TODO)</div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <div class='ticket-products-wrapper flex-center-right-column full-width'>
                  <div class='product-wrapper-header flex-center-left-row'>
                    <h4>Products - <span>3</span></h4>
                  </div>
                  <div class='table-header secondary-table-header flex-center-center-row'>
                    <div class='column-header column-header-a'></div>
                    <div class='column-header column-header-b'>#</div>
                    <div class='column-header column-header-c'>Products</div>
                    <div class='column-header column-header-d'></div>
                    <div class='column-header column-header-e'></div>
                    <div class='column-header column-header-f'></div>
                    <div class='column-header column-header-g'>Frames</div>
                    <div class='column-header column-header-h'>Quantity</div>
                    <div class='column-header column-header-i'>Artwork</div>
                  </div>
                  <div class='full-width flex-center-right-column'>
                    <% ticket.products.forEach((product, index) => { %>
                    <div class='product-wrapper flex-top-center-column'>
                      <div class='table-row flex-center-center-row'>
                        <div class='column-td column-td-a bg-green'>
                          <i class='fa-light fa-ellipsis-vertical text-white'></i>
                          <div class='ticket-dropdown-options dropdown'>
                            <ul>
                              <li><a href="/products/<%= product._id %>"><i class="fa-regular fa-eye"></i>View Product</a></li>
                              <li class='collapse-ticket'><i class="fa-regular fa-arrows-to-line"></i>Hide Products</li>
                            </ul>
                          </div>
                        </div>
                        <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                        <div class='column-td column-td-c product-number-column bg-white'><%= product.productNumber || 'N/A' %></div>
                        <div class='column-td column-td-d bg-white'></div>
                        <div class='column-td column-td-e bg-white'></div>
                        <div class='column-td column-td-f bg-white'></div>
                        <div class='column-td column-td-g bg-white'><%= product.framesPlusOverRun || 'N/A'%></div>
                        <div class='column-td column-td-h bg-white'><%= product.labelQty || 'N/A'%></div>
                        <div class='column-td column-td-i bg-white'><i class="fa-regular fa-image-polaroid"></i></div>
                      </div>
                    </div>
                    <% }) %>
                  </div>
                </div>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-c'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Scheduled Delta One - <span class='category-ticket-count'><%= cuttingScheduleDeltaOneTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'>Die</div>
              <div class='column-header column-header-g'>Length</div>
              <div class='column-header column-header-h'>Finish</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='cutting-schedule-delta-one-table' class='table-body flex-center-center-column'>
              <% cuttingScheduleDeltaOneTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width cutting-schedule-delta-one-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %></div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                  <div class='column-td column-td-g bg-white'>9111 (TODO)</div>
                  <div class='column-td column-td-h bg-white'>4 (TODO)</div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-d'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Scheduled Delta Two - <span class='category-ticket-count'><%= cuttingScheduleDeltaTwoTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'>Die</div>
              <div class='column-header column-header-g'>Length</div>
              <div class='column-header column-header-h'>Finish</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='cutting-schedule-delta-two-table' class='table-body flex-center-center-column'>
              <% cuttingScheduleDeltaTwoTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width cutting-schedule-delta-two-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %> </div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                  <div class='column-td column-td-g bg-white'>9111 (TODO)</div>
                  <div class='column-td column-td-h bg-white'>4 (TODO)</div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-f'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Scheduled Rofoflex - <span class='category-ticket-count'><%= cuttingScheduleRotoflexTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'>Length</div>
              <div class='column-header column-header-g'>Material</div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='cutting-schedule-rotoflex-table' class='table-body flex-center-center-column'>
              <% cuttingScheduleRotoflexTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width cutting-schedule-rotoflex-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber %></div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                  <div class='column-td column-td-g bg-white'>9111 (TODO)</div>
                  <div class='column-td column-td-h bg-white'>4 (TODO)</div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-e'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>On Hold - <span class='category-ticket-count'><%= cuttingOnHoldTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'>Hold Status</div>
              <div class='column-header column-header-f'>Die</div>
              <div class='column-header column-header-g'>Length</div>
              <div class='column-header column-header-h'>Finish</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='cutting-on-hold-table' class='table-body flex-center-center-column'>
              <% cuttingOnHoldTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width cutting-on-hold-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %> </div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'>1,920 ft (TODO)</div>
                  <div class='column-td column-td-g bg-white'>9111 (TODO)</div>
                  <div class='column-td column-td-h bg-white'>4 (TODO)</div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>
      </div>
  
      <div class="department-end-frame flex-center-center-row full-width">
        <div class="department-divide-line"></div><h4>End Cutting</h4><div class="department-divide-line"></div>
      </div>

      <% const numberOfWindingTickets = Object.values(windingTicketsGroupedByDepartmentStatus).flat().length %>
      <!-- Winding Department -->
      <div class='department-wrapper card' data-department="WINDING">
        <h4 class='department-name'>Winding - <span class='text-blue' id='departmentTotalTickets'><%= numberOfWindingTickets %></span></h4>

        <div class='department-section department-section-a'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-green'>In Progress - <span class='category-ticket-count'><%= windingInProgressTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'>Location</div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'>Rolls</div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='winding-in-progress-table' class='table-body flex-center-center-column'>
              <% windingInProgressTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width winding-in-progress-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-purple text-white'>Rush (TODO)</div>
                  <div class='column-td column-td-e bg-white'>
                    <div class='user-cell bg-blue tooltip'>SV
                      <span class="tooltiptext">Storm Vaske (TODO)</span>
                    </div><span class='machine-name'>Press 1 (TODO)</span>
                  </div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'>18 (TODO)</div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-b'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Ready For Scheduling - <span class='category-ticket-count'><%= windingReadyForSchedulingTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'>Location</div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'>Rolls</div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='winding-ready-for-scheduling-table' class='table-body flex-center-center-column'>
              <% windingReadyForSchedulingTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width winding-ready-for-scheduling-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'>24 (TODO)</div>
                  <div class='column-td column-td-h bg-white'>3 <%= ticket.products.length %> </div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <div class='ticket-products-wrapper flex-center-right-column full-width'>
                  <div class='product-wrapper-header flex-center-left-row'>
                    <h4>Products - <span>3</span></h4>
                  </div>
                  <div class='table-header secondary-table-header flex-center-center-row'>
                    <div class='column-header column-header-a'></div>
                    <div class='column-header column-header-b'>#</div>
                    <div class='column-header column-header-c'>Products</div>
                    <div class='column-header column-header-d'></div>
                    <div class='column-header column-header-e'></div>
                    <div class='column-header column-header-f'></div>
                    <div class='column-header column-header-g'>Frames</div>
                    <div class='column-header column-header-h'>Quantity</div>
                    <div class='column-header column-header-i'>Artwork</div>
                  </div>
                  <div class='full-width flex-center-right-column'>
                    <% ticket.products.forEach((product, index) => { %>
                    <div class='product-wrapper flex-top-center-column'>
                      <div class='table-row flex-center-center-row'>
                        <div class='column-td column-td-a bg-green'>
                          <i class='fa-light fa-ellipsis-vertical text-white'></i>
                          <div class='ticket-dropdown-options dropdown'>
                            <ul>
                              <li><a href="/products/<%= product._id %>"><i class="fa-regular fa-eye"></i>View Product</a></li>
                              <li class='collapse-ticket'><i class="fa-regular fa-arrows-to-line"></i>Hide Products</li>
                            </ul>
                          </div>
                        </div>
                        <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                        <div class='column-td column-td-c product-number-column bg-white'><%= product.productNumber || 'N/A' %></div>
                        <div class='column-td column-td-d bg-white'></div>
                        <div class='column-td column-td-e bg-white'></div>
                        <div class='column-td column-td-f bg-white'></div>
                        <div class='column-td column-td-g bg-white'><%= product.framesPlusOverRun || 'N/A'%></div>
                        <div class='column-td column-td-h bg-white'><%= product.labelQty || 'N/A'%></div>
                        <div class='column-td column-td-i bg-white'><i class="fa-regular fa-image-polaroid"></i></div>
                      </div>
                    </div>
                    <% }) %>
                  </div>
                </div>
              </div>
              <% }) %>
            </div>
          </div>
        </div>
    
        <div class='department-section department-section-e'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>On Hold - <span class='category-ticket-count'><%= windingOnHoldTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'>Location</div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'>Rolls</div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='winding-on-hold-table' class='table-body flex-center-center-column'>
              <% windingOnHoldTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width winding-on-hold-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'>3 (TODO)</div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %></div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>
      </div>

      <div class="department-end-frame flex-center-center-row full-width">
        <div class="department-divide-line"></div><h4>End of Winding</h4><div class="department-divide-line"></div>
      </div>

      <% const numberOfShippingTickets = Object.values(shippingTicketsGroupedByDepartmentStatus).flat().length %>
      <!-- Shipping Department -->
      <div class='department-wrapper card' data-department="SHIPPING">
        <h4 class='department-name'>Shipping - <span class='text-blue' id='departmentTotalTickets'><%= numberOfShippingTickets %></span></h4>

        <div class='department-section department-section-a'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-green'>In Progress - <span class='category-ticket-count'><%= shippingInProgressTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'>Grouped</div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='shipping-in-progress-table' class='table-body flex-center-center-column'>
              <% shippingInProgressTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width shipping-in-progress-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-purple text-white'>Rush (TODO)</div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %> </div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-b'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Ready For Shipping - <span class='category-ticket-count'><%= shippingReadyForShippingTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'>Grouped</div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='shipping-ready-for-shipping-table' class='table-body flex-center-center-column'>
              <% shippingReadyForShippingTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width shipping-ready-for-shipping-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %></div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <div class='ticket-products-wrapper flex-center-right-column full-width'>
                  <div class='product-wrapper-header flex-center-left-row'>
                    <h4>Products - <span>3</span></h4>
                  </div>
                  <div class='table-header secondary-table-header flex-center-center-row'>
                    <div class='column-header column-header-a'></div>
                    <div class='column-header column-header-b'>#</div>
                    <div class='column-header column-header-c'>Products</div>
                    <div class='column-header column-header-d'></div>
                    <div class='column-header column-header-e'></div>
                    <div class='column-header column-header-f'></div>
                    <div class='column-header column-header-g'>Frames</div>
                    <div class='column-header column-header-h'>Quantity</div>
                    <div class='column-header column-header-i'>Artwork</div>
                  </div>
                  <div class='full-width flex-center-right-column'>
                    <% ticket.products.forEach((product, index) => { %>
                    <div class='product-wrapper flex-top-center-column'>
                      <div class='table-row flex-center-center-row'>
                        <div class='group-lines'></div>
                        <div class='column-td column-td-a bg-green'>
                          <i class='fa-light fa-ellipsis-vertical text-white'></i>
                          <div class='ticket-dropdown-options dropdown'>
                            <ul>
                              <li><a href="/products/<%= product._id %>"><i class="fa-regular fa-eye"></i>View Product</a></li>
                              <li class='collapse-ticket'><i class="fa-regular fa-arrows-to-line"></i>Hide Products</li>
                            </ul>
                          </div>
                        </div>
                        <div class='column-td column-td-b bg-white'></div>
                        <div class='column-td column-td-c product-number-column bg-white'><%= product.productNumber || 'N/A' %></div>
                        <div class='column-td column-td-d bg-white'></div>
                        <div class='column-td column-td-e bg-white'></div>
                        <div class='column-td column-td-f bg-white'></div>
                        <div class='column-td column-td-g bg-white'><%= product.framesPlusOverRun || 'N/A'%></div>
                        <div class='column-td column-td-h bg-white'><%= product.labelQty || 'N/A'%></div>
                        <div class='column-td column-td-i bg-white'><i class="fa-regular fa-image-polaroid"></i></div>
                      </div>
                    </div>
                    <% }) %>
                  </div>
                </div>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-e'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>On Hold - <span class='category-ticket-count'><%= shippingOnHoldTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Ticket Number</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'>Grouped</div>
              <div class='column-header column-header-h'>Products</div>
              <div class='column-header column-header-i'>Due Date</div>
            </div>
            <div id='shipping-on-hold-table' class='table-body flex-center-center-column'>
              <% shippingOnHoldTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width shipping-on-hold-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %> </div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#<%= ticket.ticketNumber || 'N/A' %></div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'><%= ticket.products.length %></div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <div class='ticket-products-wrapper flex-center-right-column full-width'>
                  <div class='product-wrapper-header flex-center-left-row'>
                    <h4>Products - <span>3</span></h4>
                  </div>
                  <div class='table-header secondary-table-header flex-center-center-row'>
                    <div class='column-header column-header-a'></div>
                    <div class='column-header column-header-b'>#</div>
                    <div class='column-header column-header-c'>Products</div>
                    <div class='column-header column-header-d'></div>
                    <div class='column-header column-header-e'></div>
                    <div class='column-header column-header-f'></div>
                    <div class='column-header column-header-g'>Frames</div>
                    <div class='column-header column-header-h'>Quantity</div>
                    <div class='column-header column-header-i'>Artwork</div>
                  </div>
                  <div class='full-width flex-center-right-column'>
                    <% ticket.products.forEach((product, index) => { %>
                    <div class='product-wrapper flex-top-center-column'>
                      <div class='table-row flex-center-center-row'>
                        <div class='group-lines'></div>
                        <div class='column-td column-td-a bg-green'>
                          <i class='fa-light fa-ellipsis-vertical text-white'></i>
                          <div class='ticket-dropdown-options dropdown'>
                            <ul>
                              <li><a href="/products/<%= product._id %>"><i class="fa-regular fa-eye"></i>View Product</a></li>
                              <li class='collapse-ticket'><i class="fa-regular fa-arrows-to-line"></i>Hide Products</li>
                            </ul>
                          </div>
                        </div>
                        <div class='column-td column-td-b bg-white'></div>
                        <div class='column-td column-td-c product-number-column bg-white'><%= product.productNumber || 'N/A' %></div>
                        <div class='column-td column-td-d bg-white'></div>
                        <div class='column-td column-td-e bg-white'></div>
                        <div class='column-td column-td-f bg-white'></div>
                        <div class='column-td column-td-g bg-white'><%= product.framesPlusOverRun || 'N/A'%></div>
                        <div class='column-td column-td-h bg-white'><%= product.labelQty || 'N/A'%></div>
                        <div class='column-td column-td-i bg-white'><i class="fa-regular fa-image-polaroid"></i></div>
                      </div>
                    </div>
                    <% }) %>
                  </div>
                </div>
              </div>
              <% }) %>
            </div>
          </div>
        </div>

        <div class='department-section department-section-c'>
          <div class='header flex-center-left-row'>
            <%- include('partials/department-expand-options.ejs') %>
            <h3 class='category-header text-purple'>Arrival Plate / Die - <span class='category-ticket-count'><%= shippingToolArrivalTickets.length %></span></h3>
          </div>
          <div class='table ticket-container flex-top-center-column'>
            <div class='table-header flex-center-center-row'>
              <div class='column-header column-header-a'></div>
              <div class='column-header column-header-b'>#</div>
              <div class='column-header column-header-c'>Type</div>
              <div class='column-header column-header-d'>Status</div>
              <div class='column-header column-header-e'></div>
              <div class='column-header column-header-f'></div>
              <div class='column-header column-header-g'></div>
              <div class='column-header column-header-h'></div>
              <div class='column-header column-header-i'>Arrival Date</div>
            </div>
            <div id='shipping-tool-arrivals-table' class='table-body flex-center-center-column'>
              <% shippingToolArrivalTickets.forEach((ticket, index) => { %>
              <div id='ticket-row-<%= ticket._id %>' class='table-row-wrapper full-width shipping-tool-arrivals-row'>
                <%- include('partials/start-job-modal.ejs', {
                  ticket: ticket
                  }
              ) %>
                <div class='table-row flex-center-center-row'>
                  <div class='column-td column-td-a bg-green'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'><%= index + 1 %></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>Plate (TODO)</div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'></div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4 (TODO)</div>
                </div>
                <%- include('partials/products-wrapper.ejs', {
                  ticket: ticket
                  }
              ) %>
              </div>
              <% }) %>
            </div>
          </div>
        </div>
      </div>

      <div class="department-end-frame flex-center-center-row full-width">
        <div class="department-divide-line"></div><h4>End Shipping</h4><div class="department-divide-line"></div>
      </div>

      <% const numberOfBillingTickets = Object.values(billingTicketsGroupedByDepartmentStatus).flat().length %>
      <!-- Billing Department -->
      <div class='department-wrapper card' data-department="BILLING">
        <h4 class='department-name'>Billing - <span class='text-blue' id='departmentTotalTickets'><%= numberOfBillingTickets %></span></h4>

          <div class='department-section department-section-a'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li class='collapse-group'><i class="fa-regular fa-minimize"></i>Hide This Department</li>
                    <li class='expand-group'><i class="fa-regular fa-maximize"></i>Show This Department</li>
                    <li class='collapse-all-groups'><i class="fa-regular fa-minimize"></i>Hide All Departmens</li>
                    <li class='expand-all-groups'><i class="fa-regular fa-maximize"></i>Show All Departments</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-green'>Ready For Billing - <span class='category-ticket-count'><%= billingReadyForBillingTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'></div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'></div>
                <div class='column-header column-header-h'></div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div id='billing-ready-for-billing-table' class='table-body flex-center-center-column'>
                <% billingReadyForBillingTickets.forEach((ticket, index) => { %>
                <div id='ticket-row-<%= ticket._id %>' class='table-row flex-center-center-row billing-ready-for-billing-row'>
                  <div class='column-td column-td-a'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#47001</div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'></div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4</div>
                </div>
                <div class='table-row flex-center-center-row'>
                  <div class='group-lines'></div>
                  <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <a href="/tickets/<%= ticket.id %>"><li><i class="fa-regular fa-eye"></i>View Ticket</li></a>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          </ul>
                        </div>
                      </div>
                  <div class='column-td column-td-b bg-white'></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#47001</div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'></div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4</div>  
                </div>
                <% }) %>
              </div>
            </div>
          </div>

          <div class='department-section department-section-a'>
            <div class='header flex-center-left-row'>
              <div class='expanded-options-wrapper'>
                <div class='expanded-options-btn flex-center-center-row'>
                  <i class="fa-solid fa-caret-down"></i>
                </div>
                <div class='expanded-options-dropdown dropdown'>
                  <ul>
                    <li class='collapse-group'><i class="fa-regular fa-minimize"></i>Hide This Department</li>
                    <li class='expand-group'><i class="fa-regular fa-maximize"></i>Show This Department</li>
                    <li class='collapse-all-groups'><i class="fa-regular fa-minimize"></i>Hide All Departmens</li>
                    <li class='expand-all-groups'><i class="fa-regular fa-maximize"></i>Show All Departments</li>
                  </ul>
                </div>
              </div>
              <h3 class='category-header text-green'>In Progress - <span class='category-ticket-count'><%= billingInProgressTickets.length %></span></h3>
            </div>
            <div class='table ticket-container flex-top-center-column'>
              <div class='table-header flex-center-center-row'>
                <div class='column-header column-header-a'></div>
                <div class='column-header column-header-b'>#</div>
                <div class='column-header column-header-c'>Ticket Number</div>
                <div class='column-header column-header-d'></div>
                <div class='column-header column-header-e'></div>
                <div class='column-header column-header-f'></div>
                <div class='column-header column-header-g'></div>
                <div class='column-header column-header-h'></div>
                <div class='column-header column-header-i'>Due Date</div>
              </div>
              <div id='billing-in-progress-table' class='table-body flex-center-center-column'>
                <% billingInProgressTickets.forEach((ticket, index) => { %>
                <div id='ticket-row-<%= ticket._id %>' class='table-row flex-center-center-row billing-in-progress-row'>
                  <div class='column-td column-td-a'>
                    <i class='fa-light fa-ellipsis-vertical text-white'></i>
                    <%- include('partials/ticket-dropdown-options.ejs', {
                      ticket: ticket
                      }
                  ) %>
                  </div>
                  <div class='column-td column-td-b bg-white'></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#47001</div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'></div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4</div>
                </div>
                <div class='table-row flex-center-center-row'>
                  <div class='group-lines'></div>
                  <div class='column-td column-td-a'>
                        <i class='fa-light fa-ellipsis-vertical text-white'></i>
                        <div class='ticket-dropdown-options dropdown'>
                          <ul>
                            <a href="/tickets/<%= ticket.id %>"><li><i class="fa-regular fa-eye"></i>View Ticket</li></a>
                            <li><i class="fa-regular fa-circle-arrow-right"></i>Move</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide This Group</li>
                            <li><i class="fa-regular fa-minimize"></i>Hide All Groups</li>
                          </ul>
                        </div>
                      </div>
                  <div class='column-td column-td-b bg-white'></div>
                  <div class='column-td column-td-c bg-white ticket-number-column'>#47001</div>
                  <div class='column-td column-td-d bg-white'></div>
                  <div class='column-td column-td-e bg-white'></div>
                  <div class='column-td column-td-f bg-white'></div>
                  <div class='column-td column-td-g bg-white'></div>
                  <div class='column-td column-td-h bg-white'></div>
                  <div class='column-td column-td-i bg-white due-date-preview'>July 4</div>  
                </div>
                <% }) %>
              </div>
            </div>
          </div>
      </div>
       <%- include('partials/department-status-clones.ejs') %>
  </div>
</div>


